---
# Namespace for crypto streaming
apiVersion: v1
kind: Namespace
metadata:
  name: crypto-streaming

---
# ConfigMap for application config
apiVersion: v1
kind: ConfigMap
metadata:
  name: crypto-config
  namespace: crypto-streaming
data:
  KAFKA_BOOTSTRAP_SERVERS: "kafka-service:9092"
  KAFKA_TOPIC: "binance"
  MONGO_DB: "BigData"
  MONGO_TUMBLING_COLLECTION: "agg_tumbling_1m"
  MONGO_SLIDING_COLLECTION: "agg_sliding_30s"
  GCS_BUCKET: "your-bucket-name"
  GCS_RAW_PATH: "raw-trades"

---
# Secret for sensitive data
apiVersion: v1
kind: Secret
metadata:
  name: crypto-secrets
  namespace: crypto-streaming
type: Opaque
stringData:
  # MongoDB Atlas connection string
  MONGO_URI: "mongodb+srv://username:password@cluster.mongodb.net/?retryWrites=true&w=majority"
  
  # GCS service account key (base64 encoded JSON)
  # Create with: cat key.json | base64 -w 0
  GCS_KEY_JSON: |
    {
      "type": "service_account",
      "project_id": "your-project",
      "private_key_id": "...",
      "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
      "client_email": "...",
      "client_id": "...",
      "auth_uri": "https://accounts.google.com/o/oauth2/auth",
      "token_uri": "https://oauth2.googleapis.com/token",
      "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs"
    }

---
# PersistentVolume for Spark checkpoints
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: spark-checkpoint-pvc
  namespace: crypto-streaming
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi